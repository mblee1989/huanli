10GE---超长距离的万兆以太网
简介
在这20年中，以太网由最初10Base5 10M粗缆总线发展为10Base2 10M细缆，其后是一个短暂的后退：1Base5的1兆以太网，随后以太网技术发展成为大家熟悉的星形的双绞线10BaseT。随着对带宽要求的提高以及器件能力的增强出现了快速以太网：五类线传输的100BaseTX、三类线传输的100BaseT4和光纤传输的100BaseFX。随着带宽的进一步提高，千兆以太网接口粉墨登场：包括短波长光传输1000Base-SX、长波长光传输1000Base-LX以及五类线传输1000BaseT。2002年7月18日IEEE通过了802.3ae：10Gbit/s以太网又称万兆以太网。
万兆以太网并非将千兆以太网的速率简单地提高到10倍，这里有许多技术上的问题要解决。[1] 
在以太网技术中，100BaseT是一个里程碑，确立了以太网技术在桌面的统治地位。千兆以太网以及随后出现的万兆以太网标准是两个比较重要的标准，以太网技术通过这两个标准从桌面的局域网技术延伸到校园网以及城域网的汇聚和骨干。
以太网从10Mb/s到10Gb/s的演进证明了以太网是：
1）可扩展的（从10Mb/s到10Gb/s）。
2）灵活的（多种媒体、全/半双工、共享/交换）。
3）易于安装。
4）稳健性好。[1] 
成立背景
以太网主要在局域网中占绝对优势。但是在很长的一段时间中，人们普遍认为以太网不能用于城域网，
相关资料相关资料
特别是汇聚层以及骨干层。主要原因在于以太网用作城域网骨干带宽太低（10M以及100M快速以太网的时代），传输距离过短。当时认为最有前途的城域网技术是FDDI和DQDB。随后的几年里ATM技术成为热点，几乎所有人都认为ATM将成为统一局域网、城域网和广域网的唯一技术。但是由于种种原因，当前在国内上述三种技术中只有ATM技术成为城域网汇聚层和骨干层的备选方案。
目前最常见的以太网是10M以太网以及100M以太网（快速以太网）。100M快速以太网作为城域骨干网带宽显然不够。即使使用多个快速以太网链路绑定使用，对多媒体业务仍然是心有余而力不足。随着千兆以太网的标准化以及在生产实践中的广泛应用，以太网技术逐渐延伸到城域网的汇聚层。千兆以太网通常用作将小区用户汇聚到城域POP点，或者将汇聚层设备连接到骨干层。但是在当前10M以太网到用户的环境下，千兆以太网链路作为汇聚也是勉强，作为骨干则是力所不能及。虽然以太网多链路聚合技术已完成标准化且多厂商互通指日可待，可以将多个千兆链路捆绑使用。但是考虑光纤资源以及波长资源，链路捆绑一般只用在POP点内或者短距离应用环境。
传输距离也曾经是以太网无法作为城域数据网骨干层汇聚层链路技术的一大障碍。无论是10M、100M还是千兆以太网，由于信噪比、碰撞检测、可用带宽等原因五类线传输距离都是100m。使用光纤传输时距离限制由以太网使用的主从同步机制所制约。802.3规定1000Base-SX接口使用纤芯62.5μm的多模光纤最长传输距离275m，使用纤芯50μm的多模光纤最长传输距离550m；1000Base－LX接口使用纤芯62.5μm的多模光纤最长传输距离550m，使用纤芯50μm的多模光纤最长传输距离550m，使用纤芯为10μm的单模光纤最长传输距离5000m。最长传输距离5km千兆以太网链路在城域范围内远远不够。虽然基于厂商的千兆接口实现已经能达到80km传输距离，而且一些厂商已完成互通测试，但是毕竟是非标准的实现，不能保证所有厂商该类接口的互联互通。
综上所述，以太网技术不适于用在城域网骨干/汇聚层的主要原因是带宽以及传输距离。随着万兆以太网技术的出现，上述两个问题基本已得到解决。
技术简介
以太网采用CSMA/CD机制，即带碰撞检测的载波监听多重访问。千兆以太网接口基本应用在点到点线路，不再共享带宽。碰撞检测，载波监听和多重访问已不再重要。千兆以太网与传统低速以太网最大的相似之处在于采用相同的以太网帧结构。万兆以太网技术与千兆以太网类似，仍然保留了以太网帧结构。通过不同的编码方式或波分复用提供10Gbit/s传输速度。所以就其本质而言，10G以太网仍是以太网的一种类型。
10G以太网于2002年7月在IEEE通过。10G以太网包括10GBASE－X、10GBASE－R、10GBASE－W以及基于铜缆的10GBASE－T等(2006年通过)。10GBASE－X使用一种特紧凑包装，含有1个较简单的WDM器件、4个接收器和4个在1300nm波长附近以大约25nm为间隔工作的激光器，每一对发送器/接收器在3.125Gbit/s速度（数据流速度为2.5Gbit/s）下工作。10GBASE－R是一种使用64B/66B编码（不是在千兆以太网中所用的8B/10B）的串行接口，数据流为10.000Gbit/s，因而产生的时钟速率为10.3Gbit/s。10GBASE－W是广域网接口，与SONET OC-192兼容，
万兆以太网万兆以太网
其时钟为9.953Gbit/s数据流为9.585Gbit/s。
10G串行物理媒体层
用于局域网的光纤万兆以太网规范有：10GBase-SR、10GBase-LR和10GBase-ER。
1、10GBase-SR
10GBase-SR中的“SR”是“short range”（短距离）的缩写，表示仅用于短距离连接。该规范支持编码方式为64B/66B的短波（波长为850nm）多模光纤（MMF），有效传输距离为2米到300米。
2、10GBase-LR
10GBase-LR中的“LR”是“Long Range”（长距离）的缩写，表示主要用于长距离连接。该规范支持编码方式为64B/66B的长波（1310nm）单模光纤（SMF），有效传输距离为2米到10公里。
4、10GBase-ER
10GBase-ER中的“ER”是“Extended Range”（超长距离）的缩写，表示连接距离可以非常长。该规范支持编码方式为64B/66B的超长波（1550nm）单模光纤（SMF），有效传输距离为2米到40公里。
PMD子层功能
PMD子层的功能是支持在PMA子层和介质之间交换串行化的符号代码位。PMD子层将这些电信号转换成适合于在某种特定介质上传输的形式。PMD是物理层的最低子层，标准中规定物理层负责从介质上发送和接收信号。
PMA子层功能
PMA子层提供了PCS和PMD层之间的串行化服务接口。和PCS子层的连接称为PMA服务接口。另外PMA子层还从接收位流中分离出用于对接收到的数据进行正确的符号对齐（定界）的符号定时时钟。
WIS子层功能
WIS子层是可选的物理子层，可用在PMA与PCS之间，产生适配ANSI定义的SONET STS-192c传输格式或ITU定义SDH VC－4－64c容器速率的以太网数据流。该速率数据流可以直接映射到传输层而不需要高层处理。
PCS子层功能
PCS子层位于协调子层（通过GMII）和物理介质接入层（PMA）子层之间。PCS子层完成将经过完善定义的以太网MAC功能映射到现存的编码和物理层信号系统的功能上去。PCS子层和上层RS/MAC的接口由XGMII提供，与下层PMA接口使用PMA服务接口。
RS(协调子层)和XGMII
协调子层的功能是将XGMII的通路数据和相关控制信号映射到原始PLS服务接口定义(MAC/PLS)接口上。XGMII接口提供了10Gbit/s的MAC和物理层间的逻辑接口。XGMII和协调子层使MAC可以连接到不同类型的物理介质上。
由于10G以太网实质上是高速以太网，所以为了与传统的以太网兼容必须采用传统以太网的帧格式承载业务。为了达到10Gbit/s的高速率可以采用OC-192c帧格式传输。这就需要在物理子层实现从以太网帧到OC-192c帧格式的映射功能。同时，由于以太网的原设计是面向局域网的，网络管理功能较弱，传输距离短并且其物理线路没有任何保护措施。当以太网作为广域网进行长距离、高速率传输时必然会导致线路信号频率和相位产生较大的抖动，而且以太网的传输是异步的，在接收端实现信号同步比较困难。因此，如果以太网帧要在广域网中传输，需要对以太网帧格式进行修改。
以太网一般利用物理层中特殊的10B(Byte)代码实现帧定界的。当MAC层有数据需要发送时，PCS子层对这些数据进行8B/10B编码，当发现帧头和帧尾时，自动添加特殊的码组SFD(帧起始定界符)和EFD（帧结束定界符）；当PCS子层收到来自底层的10B编码数据时，可很容易地根据SFD和EFD找到帧的起始和结束从而完成帧定界。但是SDH中承载的千兆以太网帧定界不同于标准的千兆以太网帧定界，因为复用的数据已经恢复成8B编码的码组，去掉了SFD和EFD。如果只利用千兆以太网的前导(Preamble)和帧起始定界符（SFD）进行帧定界，由于信息数据中出现与前导和帧起始定界符相同码组的概率较大，采用这样的帧定界策略可能会造成接收端始终无法进行正确的以太网帧定界。为了避免上述情况，10G以太网采用了HEC策略。
IEEE802.3 HSSG小组为此提出了修改千兆以太网帧格式的建议，在以太网帧中添加了长度域和HEC域。
万兆以太网万兆以太网
为了在定帧过程中方便查找下一个帧位置，同时由于最大帧长为1518字节，则最少需要11个比特（=2048），所以在复接MAC帧的过程中用两个字节替换前导头两个字节作为长度字段，然后对这8个字节进行CRC-16校验，将最后得到的两个字节作为HEC插入SFD之后。
10G WAN物理层并不是简单的将以太网MAC帧用OC-192c承载。虽然借鉴了OC-192c的块状帧结构、指针、映射以及分层的开销，但是在SDH帧结构的基础上做了大量的简化，使得修改后的以太网对抖动不敏感，对时钟的要求不高。具体表现在：减少了许多开销字节，仅采用了帧定位字节A1和A2、段层误码监视B1、踪迹字节J0、同步状态字节S1、保护倒换字节K1和K2以及备用字节Z0，对没有定义或没有使用的字节填充00000000。减少了许多不必要的开销，简化了SDH帧结构，与千兆以太网相比，增强了物理层的网络管理和维护，可在物理线路上实现保护倒换。其次，避免了繁琐的同步复用，信号不是从低速率复用成高速率流，而是直接映射到OC-192c净负荷中。
10G以太局域网和10G以太广域网（采用OC-192c）物理层的速率不同，10G以太局域网的数据率为10Gbit/s,而10G以太广域网的数据率为9.58464Gbit/s（SDH OC-192c，是PCS层未编码前的速率），但是两种速率的物理层共用一个MAC层，MAC层的工作速率为10Gbit/s。采用什么样的调整策略将10GMII接口的10Gbit/s传输速率降低，使之与物理层的传输速率9.58464Gbit/s相匹配，是10G以太广域网需要解决的问题。目前将10Gbit/s速率适配为9.58464Gbit/s的OC-192c的调整策略有3种：
在GMII接口处发送HOLD信号，MAC层在一个时钟周期停止发送；
利用“Busy idle”，物理层向MAC层在IPG期间发送“Busy idle”，MAC层收到后，暂停发送数据。物理层向MAC层在IPG期间发送“Normal idle”, MAC层收到后，重新发送数据；
采用IPG延长机制：MAC帧每次传完一帧，根据平均数据速率动态调整IPG间隔。
技术展望
万兆以太网在设计之初就考虑城域骨干网需求。首先带宽10G足够满足现阶段以及未来一段时间内城域骨干网带宽需求（现阶段多数城域骨干网骨干带宽不超过2.5G）。其次万兆以太网最长传输距离可达40公里，且可以配合10G传输通道使用，足够满足大多数城市城域网覆盖。　采用万兆以太网作为城域网骨干可以省略骨干网设备的POS或者ATM链路。首先可以节约成本：以太网端口价格远远低于相应的POS端口或者ATM端口。其次可以使端到端采用以太网帧成为可能：一方面可以端到端使用链路层的VLAN信息以及优先级信息，另一方面可以省略在数据设备上的多次链路层封装解封装以及可能存在的数据包分片，简化网络设备。在城域网骨干层采用万兆以太网链路可以提高网络性价比并简化网络。
我们可以清楚地看到，10G以太网可以应用在校园网、城域网、企业网等。但是由于当前宽带业务并未广泛开展，人们对单端口10G骨干网的带宽没有迫切需求，所以10G以太网技术相对其他替代的链路层技术（例如2.5G POS、捆绑的千兆以太网）并没有明显优势。思科和JUNIPER公司已推出10G以太网接口（依据802.3ae草案实现），但在国内几乎没有应用。目前城域网的问题不是缺少带宽，而是消耗大量带宽的Killer
万兆以太网万兆以太网
Application，是如何将城域网建设成为可管理、可运营并且可盈利的网络。所以10G以太网技术的应用将取决于宽带业务的开展。只有广泛开展宽带业务，例如视频组播、高清晰度电视和实时游戏等，才能促使10G以太网技术广泛应用，推动网络健康有序发展。
技术特点
万兆以太网技术提供更加丰富的带宽和处理能力，能够有效地节约用户在链路上的投资，并保持以太网一贯的兼容性、简单易用和升级容易的特点。但是，我们也看到，由于万兆以太网尚处于发展初期，还存在着一些问题和不足：首先，在价格方面，目前一个10GE端口的价格是GE端口的100倍左右，尤其是在带宽得不到充分利用的情况下，会造成投资的极大浪费；其次，万兆以太网继承了以太网一贯的弱QoS特点，如何进行有保障的区分业务承载的问题仍然没有解决，RPR、MPLS等特性的支持尚不成熟；再有，10GE要求设备具有强大的处理能力，而目前业界有些厂商推出的10GE端口并达不到真正的线速处理，带宽优势大打折扣。
针对上述问题以及目前网络带宽需求不太迫切的现状，建议网络建设侧重业务和性价比，网络核心仍采用2.5GPOS接口或GE Trunk方式，当万兆以太网在技术和成本方面得到重大进步之后，再平滑升级至万兆。
技术优势
万兆以太网的优势之一，就是它可以用与千兆以太网相同的外形接口，获得十倍的带宽。这适用于交换机端口和主机适配器端口。例如，在一台主机服务器上，如果需要八个千兆以太网网卡接口，可以使用两个四口网卡、四个双口网卡或者八个单口网卡。这会占用两个、四个或者八个服务器I/O插槽，而且导致有八条线缆从服务器出来。有些情况可以这么做，但并不是所有服务器都有这么多的插槽，有些服务器I/O插槽需要用作其他目的，例如RAID控制器、光纤通道主机总线适配器（HBA卡）、PCI Express（PCIe）SSD等等。如果使用万兆以太网端口，用一块双口万兆以太网卡，一个端口就能提供达到八个千兆以太网接口的带宽，而还剩一个用于故障切换或者其他管理目的。这只会占用一个I/O插槽，释放了I/O插槽，同时也减少了电能消耗。而且不再需要两条以上的线缆了。此外，相同的双端口万兆以太网卡可以安装在更小的服务器上，例如只有两个插槽的1U高的服务器，仍然可以提供充足的网络带宽。[2] 
发展历程
在国内网络厂商中，华为公司率先推出了支持万兆的高端路由器和交换机Quidway S8500（8505/8512），定位于电信级运营核心网络汇聚层、园区网络和企业网络的核心。Quidway S8500万兆多层核心交换机具有容量大、业务接口特性丰富、协议支持完备等特点，背板容量1.2T，交换容量480Gbps，以太网接口最大提供12个万兆以太网接口，并具有强大的VPN支持能力和完善的QoS能力。同期推出的Quidway NetEngine5000系列万兆核心路由器是面向电信级运营核心网络的高端网络产品，采用三维交换网分布式体系结构，每个接口模块自带分布式交换网，可方便地进行堆叠和扩展，最大提供560个接口模块，整机提供11.2Tbps的交换能力，最大端口容量5.6T，支持10G POS、10GE LAN、10GE WAN接口的IP/MPLS线速转发，并支持向更高速接口平滑扩展。Quidway NetEngine 5000万兆核心路由器采用三维体系结构，在扩展性、负载平衡能力、多路径备份和无阻塞等方面具有优势，并具有可递增的扩充性，可根据需要增加交
万兆以太网万兆以太网
换容量，而不必一次性地高配置集中交换网，满足未来核心网络发展的特点和需要。
此外，华为第五代高端核心路由器Quidway NetEngine80/40也具有平滑升级至万兆的能力。Quidway系列万兆路由器和交换机的推出，标志着我国大容量核心路由器和以太网交换机的设计技术已经迈入国际一流水平，这不仅是我国核心网通信技术发展的一次重大突破，也是我国数据通信产业迈向国际化的重大突破，并将为我国信息化的进一步深入开展提供更加强劲的发展动力。
